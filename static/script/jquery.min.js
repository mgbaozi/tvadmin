!function(a){function b(b,c){this.obj=b,this.settings=c,this.trigger="self"==this.settings.trigger?this.obj:a(this.settings.trigger);var d=!1,e={x:0,y:0},f={x:0,y:0},g={x:0,y:0},h={x:0,y:0},i={x:0,y:0},j=this.settings,k=this.obj;this.trigger.live("mousedown",function(b){return j.onbeforedrag&&0==j.onbeforedrag.call([0])?!1:(e.x=b.pageX,e.y=b.pageY,g.x=parseInt(k.css("left"))||0,g.y=parseInt(k.css("top"))||0,a(document).bind("mousemove.jdrag",function(a){d||(d=!0),f.x=a.pageX,f.y=a.pageY,"xy"==j.type?(h={x:Math.min(Math.max(g.x+f.x-e.x,j.minX),j.maxX),y:Math.min(Math.max(g.y+f.y-e.y,j.minY),j.maxY)},i={x:h.x-g.x,y:h.y-g.y},k.css({left:h.x+"px",top:h.y+"px"})):"x"==j.type?(h={x:Math.min(Math.max(g.x+f.x-e.x,j.minX),j.maxX),y:parseInt(k.css("top"))},i={x:h.x-g.x,y:0},k.css({left:h.x+"px"})):"y"==j.type&&(h={x:parseInt(k.css("left")),y:Math.min(Math.max(g.y+f.y-e.y,j.minY),j.maxY)},i={x:0,y:h.y-g.y},k.css({top:h.y+"px"})),j.ondrag&&j.ondrag.call(k[0],i,h)}),!1)}),a(document).bind("mouseup.jqdrag",function(){d&&j.ondragend&&j.ondragend.call(k[0],i),a(this).unbind("mousemove.jdrag"),d=!1})}a.fn.jqdrag=function(c){var d={type:"xy",trigger:"self",maxX:+1/0,maxY:+1/0,minX:-1/0,minY:-1/0},e="JQDrag",f=this.data(e);if("string"==typeof c){if(f)return"getObject"===c?f:(f[c]&&f[c].apply(f,Array.prototype.slice.call(arguments,1)),this);throw new Error("This object is ont available!")}return this.each(function(){var f=new b(a(this),a.extend({},d,c));a(this).data(e,f)})},b.prototype.setOption=function(b,c){return this.settings=a.extend(this.settings,b),c&&this.update(),this},b.prototype.update=function(a){a&&this.setOption(a);var a=this.obj,b=this.settings;return a.css({left:Math.max(b.minX,Math.min(parseInt(a.css("left")),b.maxX))+"px",top:Math.max(b.minY,Math.min(parseInt(a.css("top")),b.maxY))+"px"}),this}}(jQuery);