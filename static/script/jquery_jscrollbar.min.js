!function(a){function b(b,c){function d(){m.obj.css({overflow:"hidden"}).wrapInner('<div class="sb-Content" style="overflow:hidden;position:relative"></div>');var b=m.obj.children(".sb-Content").scrollTop(0).scrollLeft(0);return a.browser.mozilla&&a(document).ready(function(){b.scrollTop(0)}),b}function e(b){var c=m.opts.color,d=m.opts.width;/x/i.test(b)&&(m.barXB=a('<div style="position:absolute;font-size:0;background:'+c+";opacity:0.2;filter:alpha(opacity=20);width:100%;height:"+d+'px;left:0;bottom:0;"></div>').appendTo(m.obj).bind("mousedown",function(b){var c=Math.max(Math.min(b.pageX-a(this).offset().left-m.barX.width()/2,m.barXmaxX),0);return m.barX.stop().animate({left:c},300),m._updateContentLoc({direction:"x",barXLocLeft:c,duration:300}),!1})),/y/i.test(b)&&(m.barYB=a('<div style="font-size:0;position:absolute;background:'+c+";opacity:0.2;filter:alpha(opacity=20);width:"+d+'px;height:100%;right:0;top:0"></div>').appendTo(m.obj).bind("mousedown",function(b){var c=Math.max(Math.min(b.pageY-a(this).offset().top-m.barY.height()/2,m.barYmaxY),0);return m.barY.stop().animate({top:c},300),m._updateContentLoc({direction:"y",barYLocTop:c,duration:300}),!1}))}function f(){m.obj.mousewheel&&m.obj.mousewheel(function(a){var b={horizontal:"x",vertical:"y"},c=(0>a?1:-1)*m.opts.mouseMoveAmount,d=m.opts.mouseScrollDirection,e=m.opts.showXBar,f=m.opts.showYBar;"horizontal"==d&&!e&&f&&(d="vertical"),"vertical"==d&&!f&&e&&(d="horizontal"),m.scrollBy(b[d],c)})}function g(){var a=m.obj.css({overflow:"auto"}).css("position");/(static)/gi.test(a)&&m.obj.css({position:"relative"})}function h(b){console.log("_this.opts.width:",m.opts);var d=m.opts.width,f=m.opts.position,g={},h=m.opts.opacity,i='<div class="jq-scrollbar" style="font-size:0;border-radius:6px;background:'+m.opts.color+";position:absolute;z-index:1;border-radius:"+c.borderRadius+";opacity:"+h+";filter:alpha(opacity="+100*h+");";/x/i.test(b)?(m.opts.showXBar=!0,m.barX=this.barX=a(i+"bottom:0;left:0;width:"+m.barXWidth+"px;height:"+d+'px;"></div>').appendTo(m.obj),"outer"===f?(g.height=m.height-d+"px",e("x")):g.height=m.height+"px"):/y/i.test(b)&&(m.opts.showYBar=!0,m.barY=a(i+";right:0;top:0;width:"+d+"px;height:"+m.barYHeight+'px;"></div>').appendTo(m.obj),"outer"===f?(g.width=m.width-d+"px",e("y")):g.width=m.width+"px"),m.$sbContent.css(g)}function i(a){/x/i.test(a)&&m.barX&&m.barX.jqdrag({type:"x",maxX:m.barXmaxX,minX:0,ondrag:function(){m._updateContentLoc({direction:"x"})},ondragend:function(){m._triggerEvent("x","finished")}}),/y/.test(a)&&m.barY&&m.barY.jqdrag({type:"y",maxY:m.barYmaxY,minY:0,ondrag:function(){m._updateContentLoc({direction:"y"})},ondragend:function(){m._triggerEvent("y","finished")}})}function j(){var a=m.opts.showXBar,b=m.opts.showYBar;a!==!1&&m.scrollWidth>m.width&&(h("x"),b!==!1&&m.scrollHeight>m.$sbContent.height()&&h("y")),b!==!1&&"undefined"==typeof m.barY&&m.scrollHeight>m.height&&(h("y"),a!==!1&&"undefined"==typeof m.barX&&m.$sbContent[0].scrollWidth>m.$sbContent.width()&&h("x")),c.showYBar||m.$sbContent.css({width:m.width+"px"}),c.showXBar||m.$sbContent.css({height:m.height+"px"}),m.barX&&(m.barXmaxX=m.width-m.barX.width()-("inner"!==c.position&&m.opts.showYBar?m.opts.width:0)),m.barY&&(m.barYmaxY=m.height-m.barY.height()-("inner"!==c.position&&m.opts.showXBar?m.opts.width:0)),i("xy")}function k(){var a=m.opts.position,b=m.opts.opacity,c={opacity:0},d={opacity:b};if("outer"===a);else{var e=m.obj.find(".jq-scrollbar").animate(c,1e3);m.obj.hover(function(){e.stop().animate(d,500)},function(){e.stop().animate(c,1e3)})}}function l(){m.opts.keyControl&&m.$sbContent.hover(function(){a(document).bind("keydown.jsb",function(a){var b=a.keyCode;switch(b){case 37:m.scrollBy("x",-m.opts.keyMoveAmount);break;case 38:m.scrollBy("y",-m.opts.keyMoveAmount);break;case 39:m.scrollBy("x",m.opts.keyMoveAmount);break;case 40:m.scrollBy("y",m.opts.keyMoveAmount)}/(37|38|39|40)/.test(b)&&a.preventDefault()})},function(){a(document).unbind("keydown.jsb")})}this.obj=b,this.opts=c;var m=this;g(),this.width=b.width(),this.height=b.height(),this.scrollWidth=b[0].scrollWidth,this.scrollHeight=b[0].scrollHeight,this.barXWidth=Math.min(this.width-this.opts.width-10,Math.max(10,this.width*this.width/this.scrollWidth)),this.barYHeight=Math.min(this.height-this.opts.width-10,Math.max(10,this.height*this.height/this.scrollHeight)),this.$sbContent=d(),this.barX=void 0,this.barY=void 0,this.barXmaxX=0,this.barYmaxY=0,this.barXB=null,this.barYB=null,j(),k(),l(),f()}a.fn.jscrollbar=function(c){var d={color:"black",width:12,opacity:.6,borderRadius:6,position:"outer",keyControl:!0,mouseScrollDirection:"vertical",keyMoveAmount:30,mouseMoveAmount:30},e="jscrollbar",f=this.data(e);if("string"==typeof c){if(f)return"getObject"===c?f:(f[c]&&f[c].apply(f,Array.prototype.slice.call(arguments,1)),this);throw new Error("This object is not available!")}return this.each(function(){var f=new b(a(this),a.extend({},d,c));a(this).data(e,f)})},b.prototype={getScrollPos:function(){var a=this.$sbContent[0];return{x:a.scrollLeft,y:a.scrollTop}},setBarLoc:function(){var a=this.getScrollPos(),b=this.barX,c=this.barY;return b&&b.css({left:this.barXmaxX*a.x/(this.scrollWidth-this.width)}),c&&c.css({top:this.barYmaxY*a.y/(this.scrollHeight-this.height)}),this},scrollBy:function(a,b){return this.scrollTo(a,this.getScrollPos()[a]+b),this},scrollTo:function(a,b){var c="x"==a?"scrollLeft":"scrollTop";return this.$sbContent[c](b),this.setBarLoc(),this._triggerEvent(a,"scroll"),this},_triggerEvent:function(a,b,c){if(c)return void this.obj.trigger(b,[c]);var d="x"==a?+(parseFloat(this.barX.css("left"),10)/this.barXmaxX*100).toFixed(2):+(parseFloat(this.barY.css("top"),10)/this.barYmaxY*100).toFixed(2);this.obj.trigger(b,[{direction:a,percent:d,scrollWidth:this.scrollWidth,scrollHeight:this.scrollHeight}])},updateUI:function(){return this.width=this.obj.width(),this.height=this.obj.height(),this.$sbContent.css({width:this.barY?this.width-this.opts.width:this.width,height:this.barX?this.height-this.opts.width:this.height}),this.scrollWidth=this.$sbContent[0].scrollWidth,this.scrollHeight=this.$sbContent[0].scrollHeight,this.barXWidth=Math.min(this.width-this.opts.width-10,Math.max(10,this.width*this.width/this.scrollWidth)),this.barYHeight=Math.min(this.height-this.opts.width-10,Math.max(10,this.height*this.height/this.scrollHeight)),this.barX&&(this.barXmaxX=this.width-this.barXWidth-("inner"!==this.opts.position&&this.opts.showYBar?this.opts.width:0),this.barX.css({width:this.barXWidth}),this.barX.jqdrag("setOption",{maxX:this.barXmaxX})),this.barY&&(this.barYmaxY=this.height-this.barYHeight-("inner"!==this.opts.position&&this.opts.showXBar?this.opts.width:0),this.barY.css({height:this.barYHeight}),this.barY.jqdrag("setOption",{maxY:this.barYmaxY})),this.setBarLoc()},_updateContentLoc:function(b){var b=a.extend({direction:"xy",duration:0},b),c=b.direction,d=b.barXLocLeft,e=b.barYLocTop,f="undefined"==typeof d,g="undefined"==typeof e,h=b.duration,i=this.$sbContent,j=this,k=0,l=0;/y/.test(c)&&this.barY&&(l=(g?parseFloat(this.barY.css("top")):e)/this.barYmaxY,k=(i[0].scrollHeight-i.height())*l,i.stop().animate({scrollTop:k},h,function(){j._triggerEvent("y","scroll",{direction:"y",percent:+(100*l).toFixed(2),scrollWidth:j.scrollWidth,scrollHeight:j.scrollHeight})})),/x/.test(c)&&this.barX&&(l=(f?parseFloat(this.barX.css("left")):d)/this.barXmaxX,k=(this.scrollWidth-this.width)*l,i.stop().animate({scrollLeft:k},h,function(){j._triggerEvent("x","scroll",{direction:"x",precent:+(100*l).toFixed(2),scrollWidth:j.scrollWidth,scrollHeight:j.scrollHeight})}))}}}(jQuery);